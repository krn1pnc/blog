---
title: 2024.1 做题记录
date: 2024-01-15 21:07:17
categories: 做题记录
---

## [洛谷 4785 [BalticOI 2016 Day2] 交换](https://www.luogu.com.cn/problem/P4785)

将 $x$ 和 $\lfloor x / 2 \rfloor$ 连边，交换操作即交换一对父子．我们需要贪心地将最小值换到根上．

容易发现处理完一个节点后，其两子树变为独立的子问题，故考虑如何处理一个节点．

考虑 $a, b, c$ 三个节点，其中 $a$ 是 $b$ 和 $c$ 的父亲，显然当最小值取到 $x_a$ 或 $x_b$ 上时，均可以以唯一方式交换到 $a$ 上，故方式确定．

当最小值取到 $c$ 时，我们发现需要讨论 $x_a$ 和 $x_b$ 如何分配给 $b$ 和 $c$．事实上根本不用讨论，暴力搜出所有状态即可．因为一个节点可能被分配的值只有其祖先及祖先的兄弟上的值，故总状态数 $O(n \log n)$．

## [洛谷 9962 [THUPC 2024 初赛] 一棵树](https://www.luogu.com.cn/problem/P9962)

设 $f_{u, i}$ 表示 $u$ 子树选 $i$ 个节点染成黑色的代价，考虑合并子树，有转移：

$$
f_{u, i + j} \xleftarrow{\min} f_{u, i} + f_{v, j} + |k - 2j|
$$

形如一个 $(\min, +)$ 卷积，由于 $|k - 2j|$ 是一个关于 $j$ 的凸函数，故容易归纳证得 $f_u$ 是凸的．

然后就是套路地用平衡树维护差分序列，启发式合并做 $(\min, +)$ 卷积．复杂度 $O(n \log^2 n)$，至少我只能分析到这里．

## [洛谷 6803 [CEOI2020] 星际迷航](https://www.luogu.com.cn/problem/P6803)

首先可以通过换根 DP 求出 $s_u$ 表示原树上从 $u$ 点出发是不是必胜的．然后对于第 $i$ 棵树，点 $u$ 若接上一个点 $v$ 满足 $s_v = 0$，那么 $u$ 就赢了．

考虑 $0 \to 1$ 怎样连是合法的，若 $1$ 号点是必胜点，那么树上的点可以 xjb 连到下一棵树上，只要不改变 $1$ 号点的状态就行；若 $1$ 号点是必败点，那么必须有一个会影响 $1$ 号点状态的点连到下一棵树上的必败点．

由上面的分析，我们不妨设 $f_u$ 表示会影响 $u$ 状态的点数，若我们计算出了考虑 $1 \sim D$ 的所有连接方案，$1$ 号树上的必败 / 必胜点数，那么答案就可以轻松算出．

不妨设 $g_{i, 0 / 1}$ 表示考查 $i \sim D$ 的所有连接方案，第 $i$ 棵树的非必胜 / 必胜点数和，有转移：

$$
\begin{aligned}
g_{i, 0} &= \sum_{s_u = 0} (n - f_u) g_{i + 1, 0} + \sum_{s_u = 1} f_u g_{i + 1, 0} + \sum_{s_u = 0} n g_{i + 1, 1} \\
g_{i, 1} &= \sum_{s_u = 1} (n - f_u) g_{i + 1, 0} + \sum_{s_u = 0} f_u g_{i + 1, 0} + \sum_{s_u = 1} n g_{i + 1, 1}
\end{aligned}
$$

显然可以矩阵快速幂转移．

## [洛谷 3735 [HAOI2017] 字符串](https://www.luogu.com.cn/problem/P3735)

考虑如何判定两个串 $S$ 和 $T$ 相等．首先要 $|S| = |T|$，然后是 $\operatorname{lcp}(S, T) + \operatorname{lcs}(S, T) + k \ge |S|$．

考虑对所有模式串，枚举结束位置为 $i$ 的一个前缀，那么能被计入答案的子串首先要与这个前缀匹配，且其 $i + k + 1$ 开始的后缀也要和模式串从 $i + k + 1$ 位置开始的后缀匹配．

刻画多串匹配问题，容易想到 AC 自动机．对所有模式串及其反串建立 AC 自动机，设 $p_i$ 为 $S$ 结束位置为 $i$ 的前缀匹配到的节点，$q_i$ 为 $S$ 开始位置为 $i$ 的后缀倒着匹配到的节点．对于某个模式串，类似地设出 $f_i, g_i$，那么 $S$ 中一个位置 $i$ 能被 $T$ 中的某个前缀 $j$ 计入答案的条件是 $p_i$ 在 $f_j$ 的子树中，且 $q_{i + k + 1}$ 在 $g_{i + k + 1}$ 的子树中．拍到 dfs 序上之后显然是一个二维数点，直接做即可．

乱写一通后发现这玩意不大对啊！对于 $S$ 的一个能计入模式串 $T$ 的答案的子串 $S^\prime$，设 $S^\prime$ 和 $T$ 第一次不相同的位置是 $i$，最后一次不相同的位置是 $j$．若 $j - i + 1 < k$，这个子串会被统计多次．

考虑如何去重．我们钦定这个子串在枚举 $T$ 的前缀 $i - 1$ 时被统计．考虑每次被统计到的含义，我们相当于钦定了一段长度为 $k$ 的区间不管，要求剩下的前后缀匹配．我们考虑将钦定的区间的第一个元素去掉，然后再统计满足要求的区间，显然只有前缀 $i - 1$ 不会被计入贡献．这相当于令 $k \leftarrow k - 1$ 后再运行一遍上述算法．用第一次算得的答案减去这样统计到的答案即可．

注意计算第二部分时，$[i, j]$ 贴着子串开头结尾的情况不能计入（即匹配空前后缀的情况）．此时贡献只会在第一部分中被统计一次．

## [洛谷 4482 [BJWC2018] Border 的四种求法](https://www.luogu.com.cn/problem/P4482)

## [Codeforces 343E Pumping Stations](https://codeforces.com/contest/343/problem/E)

## [洛谷 3793 由乃救爷爷](https://www.luogu.com.cn/problem/P3793)

## [洛谷 5155 [USACO18DEC] Balance Beam P](https://www.luogu.com.cn/problem/P5155)

## [洛谷 4745 [CERC2017] Gambling Guide](https://www.luogu.com.cn/problem/P4745)

## [Codeforces 321D Ciel and Flipboard](https://codeforces.com/contest/321/problem/D)

## [UOJ 553 己酸集合](https://uoj.ac/problem/553)

## [UOJ 422 【集训队作业 2018】小 Z 的礼物](https://uoj.ac/problem/422)

## [LOJ 6509 「雅礼集训 2018 Day7」C](https://loj.ac/p/6509)

## [Codeforces 914F Substrings in a String](https://codeforces.com/contest/914/problem/F)

## [Codeforces 643E Bear and Destroying Subtrees](https://codeforces.com/contest/643/problem/E)

## [Codeforces 183D T-shirt](https://codeforces.com/contest/183/problem/D)

## [LOJ 3080「2019 集训队互测 Day 5」国际象棋](https://loj.ac/p/3080)

## [Codeforces 446D DZY Loves Games](https://codeforces.com/contest/446/problem/D)
