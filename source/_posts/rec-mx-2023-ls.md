---
title: 梦熊 2023 炼石计划 做题记录
date: 2023-11-29 14:33:20
categories: 做题记录
---

## 11 月 23 日

### * A. 座号重分配

注意到

$$
a_i b_j+a_j b_k+a_k b_i \ge a_k b_j+a_j b_i+a_i b_k \iff (a_k - a_j)(b_i - b_j) - (a_i - a_j)(b_k - b_j) \ge 0
$$

故若令 $A_i = (a_i, b_i)$，那么有 $\overrightarrow{A_iA_{i + 1}} \times \overrightarrow{A_{i + 1}A_{i + 2}} \ge 0$，每次跑一次凸包，删去凸包上的点后解决子问题，然后枚举凸包上的点看如何拼接．

### * B. 实习生分配

唐．

不妨枚举 $a, b$ 的最大值 $p, q$，那么为了最小化部门 Y 的价值，$a_i \le p$ 且 $b_i \le q$ 的点全都发配到部门 X 一定不劣．按照 $p$ 降序扫描线，过程中对每个 $q$ 维护 $\max c_i + \max d_i + q$，修改形如全局取 $\max$，由于初始状态是通过前缀取 $\max$ 得到的，故事实上是区间覆盖．容易使用线段树维护，注意需要精细地保证 X 和 Y 部门都有人．

### ! C. 城镇分配

还没补．

## 11 月 26 日

### * A. 白云一片去悠悠

我们选取一个联通块中最小的且最靠左上方的元素作为这个连通块的特征元素，对联通块计数即对特征元素计数．

考虑一个元素 $(i, j)$ 何时能够成为特征元素．如果它往四个方向直走，只经过合法的格子，能够走到一个权值比自己小的格子，那么它肯定不是特征元素．现在我们尝试证明，从某个格子开始，若其上下左右四个方向上第一个权值比自己小的格子都无法通过直走到达，那么它就是一个特征元素．采用反证法，不妨设它能走到它上方的那个比自己小的格子，那么它需要绕过挡住自己的那个格子，不妨设路径是 $(i, j) \to (i, k) \to (p, k) \to (p, j)$，那么有 $b_k < b_j$，那么有 $a_i + b_k < a_i + b_j$，即 $w_{i, k} < w_{i, j}$，与四个方向上都走不到矛盾．

故设 $\mathrm{pa}_i$ 为最大的 $j$ 满足 $a_j < a_i$，$\mathrm{sa}_i$ 为最小的 $j$ 满足 $a_j < a_i$，$\mathrm{pb}_i, \mathrm{sb}_i$ 类似．那么就是求有多少点对 $(i, j)$ 满足

$$
\begin{aligned}
a_i + b_j \le x \\
a_i + \min\{\max_{k = \mathrm{pb}_j}^{j} b_k, \max_{k = j}^{\mathrm{sb}_j} b_k\} > x \\
b_j + \min\{\max_{k = \mathrm{pa}_i}^{i} a_k, \max_{k = i}^{\mathrm{sa}_i} a_k\} > x
\end{aligned}
$$

扫描线即可．

### * B. 模板性二维数点

假设我们设定了阈值 $x$，只考虑 $a_i^y < x, b_j^y > x$ 的情况，发现选取出的点对一定至少包含一个两边的最大值．考虑对 $y$ 轴分治，求出可能成为答案的点对，容易发现个数是 $O(n \log n)$．

然后扫描线即可．

### * C. 多刀流

分类讨论．

1. $m = n$ 时，只需判断整个串是否单调升，若不是则可行．
1. $m = 2$ 时，枚举分界点．
1. $m = 3$ 时，考虑是 $T_1 > T_2$ 还是 $T_2 > T_3$．

    1. $T_1 > T_2$ 时，可以被调整到 $|T_2| = 1$，直接枚举即可．
    1. $T_2 > T_3$ 时，考虑最终的划分方案：

        1. $T_2$ 中存在字符大于 $T3$ 中的字符，可以调整使得 $|T_2| = 1$．
        1. 剩下的情况，$T_2$ 中只包含一种字符，且最大化 $|T_2|$ 是最优的．

        于是直接枚举连续段作为 $T_2$ 即可．

1. $m \ge 4$ 时，只需找到一个位置 $i$ 使得 $s_i > s_{i + 1}$ 或 $s_i = s_{i + 1} = s_{i + 2}$ 即可．

## 11 月 30 日

### * A. 种豆南山

一种作物分布唯一对应一个最小的能够将所有有作物的格子框住的矩形，我们称这个矩形为这个分布的特征矩形．

考虑枚举矩形，计算特征矩形为当前矩形的分布个数．需要很麻烦的分讨．咕咕咕咕．

### ! B. 长城烽火

还没补．

### ! C. 光明教会

还没补．

## 12 月 10 日

没打．

## 12 月 14 日

### * A. 帮派斗争

### * B. 轨道对齐

回想到对于一个序列 $a_i$，存在 $k$ 次多项式 $P(x)$ 满足 $P(i) = a_i$ 的充要条件是 $a$ 的 $k + 1$ 阶差分全为 $0$．

故只用找到 $b$ 的一个循环位移，使得其的 $k + 1$ 阶差分和 $a$ 的 $k + 1$ 阶差分相同．可以轻松使用哈希解决，问题是如何快速计算高阶差分．

考查 $k + 1$ 阶差分的表达形式：

$$
\Delta^n a_i = \sum_j \binom{k + 1}{j} (-1)^{k + 1 - j} a_{i + j}
$$

是一个卷积的形式，直接 FFT 加速卷积即可．

### ! C. 增长序列

还没补．

## 12 月 17 日

### A. game

若我们预处理出了 $f_{i, j}$ 表示 $(1, 1)$ 向右下走到 $(i, j)$ 的最大权值和 $g_{i, j}$ 表示 $(R, C)$ 向左上走到 $(i, j)$ 的最大权值．

若 Bob 的路径已经确定，那么可以通过尝试拼接路径两侧的 $f$ 和 $g$ 数组来计算当前局面上 Alice 的最大权值和．把这个过程丢到一个 DP 里就可以解决本题．

具体地，设 $h_{i, j, 0 / 1}$ 表示 Bob 从 $(1, C)$ 向左下走到 $(i, j)$，上一步是横 / 竖着走的（为了提前计算拐角处贡献），Alice 的最小的最大收益．转移尝试拼上一段竖 / 横着的路径和路径末端的拐角即可．

### * B. 永无宁日 II

shaber 点分治题．

考虑计算跨越一个点 $r$ 的所有路径的贡献．对于当前的 $r$，计算连通块内所有点到 $r$ 后的危险度是多少，若不能到达就设为 $\infty$，记为 $\mathrm{up}_u$．为了计算 $\mathrm{up}_u$，我们记录 $\mathrm{rem}_u$ 表示危险度为 $\le \mathrm{rem}_u$ 的人进入 $u$ 后能够到达 $r$，有转移：

$$
\mathrm{rem}_v \leftarrow \min\{\mathrm{rem}_u - d_v, k_v\}
$$

若当前在 $u$，判定其子节点 $v$ 可达的条件为 $d_v \le \mathrm{rem}_u$．

再记 $\mathrm{dn}_u$ 表示危险度 $\le \mathrm{dn}_u$ 的人可以从 $r$ 走到 $u$．为了计算 $\mathrm{dn}_u$，我们需要记录 $s_u$ 表示 $r$ 到 $u$ 的路径上，除了 $r$ 的所有节点的权值和．有转移：

$$
\mathrm{dn}_v \leftarrow \min\{\mathrm{dn}_u, k_v - \mathrm{sum}_u\}
$$

那么相当于统计满足 $a_u \le a_v$ 且 $\mathrm{up}_u \le \mathrm{dn}_v$ 的点对 $(u, v)$ 数目，是经典的二维数点问题，扫描线即可．总复杂度为 $O(n \log^2 n)$．

### ! C. 穿梭

还没补．

## 12 月 21 日

### A. 指数爆炸

注意到幂塔只有前 30 个位置有用，故倒着 DP，转移只枚举前 30 个位置，后面的直接前缀和计算．

然后这 b 题卡常，注意到计算幂塔的模数除开前三个（分别为 $998244353, 998244352, 402653184$）均为 $2$ 的整数次幂，故使用位运算优化取模．时间复杂度 $O(n \log^3 V)$．

### * B. 购物博弈

考虑对每个左端点 $i$ 计算最小的 $f_i$，使得给 $[i, f_i]$ 这一段涨价后满足要求．答案即为 $\sum n - f_i + 1$．

注意到 $b_i > a_i$，故 $f_i$ 单调增．考虑整体二分．设当前答案值域为 $[\mathrm{pl}, \mathrm{pr}]$，对应 $f$ 的下标值域为 $[l, r]$．令 $\mathrm{pmid} = \lfloor (\mathrm{pl} + \mathrm{pr}) / 2 \rfloor$，考虑计算区间 $[l, r]$ 中最大的 $i$ 满足使 $[i, \mathrm{pmid}]$ 涨价后满足题目要求．由于 $f$ 有单调性，这个也可以二分！

复杂度貌似是 $O(nV \log n)$，但是非常不满！跑得很快．

### * C. 保守主义

垃圾东西．注意到字母对很少，考虑将询问离线，逐一计算每一对字母对询问的贡献．

对于字母对 $(c_1, c_2)$，我们可以将序列中除了 $c_1$ 和 $c_2$ 的数去掉，然后将 $c_1$ 变成 $1$，$c_2$ 变成 $0$，即求端点间的连续段数．容易使用前缀和解决，时间复杂度 $(n|\Sigma| + m|\Sigma|^2)$．
