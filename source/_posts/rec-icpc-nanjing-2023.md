---
title: ICPC 南京 2023 做题记录
date: 2023-12-12 00:16:59
categories: 做题记录
---

## A. Cool, It's Yesterday Four Times More

唐．注意到 $nm \le 10^3$，可以一遍 bfs 预处理出袋鼠 $(a, b)$ 能不能踢掉袋鼠 $(c, d)$，然后暴力枚举袋鼠对判断．

## ! B. Intersection over Union

不会几何．

## C. Primitive Root

有 $g = (kP + 1) \oplus (P - 1)$，暴力枚举 $k$ 显然不行，但是 $k$ 的取值肯定形如一段很长的连续段接很短的一段散块，计算连续段大致的端点后暴力统计散块即可．

## * D. Red Black Tree

特技 DP 题．

设 $f_{u, i}$ 表示以 $u$ 为根的子树是好的，且 $u$ 到子树中的任意叶子都有 $i$ 个黑色节点的最小代价．若令 $g_{u, 0 / 1}$ 为将 $u$ 节点变成红 / 黑的代价，那么有转移：

$$
f_{u, i} = \min_{0 \le j \le 1} \{g_{u, j} + \sum_v f_{v, i - j}\}
$$

注意到转移是一个 $(\min, +)$ 卷积，而我们知道，两个凸序列的 $(\min, +)$ 卷积一定还是凸序列，而 $g_u$ 肯定是一个凸序列，故对于所有 $u$，$f_u$ 都是凸序列．而两个凸序列的 $(\min, +)$ 卷积可以通过将两个序列的差分归并排序得到．证明可以考虑 Minkowski 和合并凸包，但是还有更简单的证法！$(\min, +)$ 卷积的本质是对每个 $i$，在两个序列的差分中各选一个前缀，使得元素数为 $i$，且和最小．由于凸序列的差分单调，直接贪心选前 $i$ 小即可．

那么拿个 `std::set` 或 `std::priority_queue` 即可维护出 DP 数组的差分．由于 $f_{u, i}$ 中，$i$ 的取值范围只有 $u$ 子树中最浅的节点到 $u$ 的距离，类似长剖可以分析出总状态数 $O(n)$．

## * E. Extending Distance

神仙东西，完全不会．

考虑网格图的对偶图，原图最短路对应对偶图最小割．问题转化为选某些边增加容量，使得最大流大小增加 $k$．

这不是我们最小费用可行流问题吗！显然可以费用流求解，但是原图最大流可能很大，伪多项式复杂度的 SSP 直接寄了．注意到大部分流量都是由费用为 $0$ 的边贡献的，费用为 $1$ 的边只会贡献 $k$ 的流量，故可以先跑 Dinic 将 $0$ 边贡献的流量流完，然后再在残量网络上跑费用流．时间复杂度 $O(n^2 m^2 k)$．
